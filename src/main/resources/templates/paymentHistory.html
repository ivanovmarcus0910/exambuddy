<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Danh sách thanh toán</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">
<div th:insert="~{fragments/header :: header}"></div>

<div class="container py-4">
  <h2 class="text-center mb-4">Lịch sử thanh toán</h2>

  <div class="card shadow-lg">
    <div class="card-body">
      <table class="table table-hover text-center">
        <thead class="table-dark">
        <tr>
          <th>Mã giao dịch</th>
          <th>Số tiền</th>
          <th>Trạng thái</th>
          <th>Thời gian</th>
          <th>Hành động</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="payment : ${payments}">
          <td th:text="${payment.paymentCode}"></td>
          <td th:text="${payment.amount}" class="text-success fw-bold"></td>
          <td>
            <span th:text="${payment.status}"
                  th:class="${payment.status == 'PAID' ? 'badge bg-success'
                            : (payment.status == 'PENDING' ? 'badge bg-warning text-dark' : 'badge bg-danger')}">
            </span>
          </td>
          <td th:text="${#dates.format(payment.timestamp, 'dd/MM/yyyy HH:mm')}" class="text-muted"></td>
          <td>
            <a th:if="${payment.status == 'PENDING'}"
               th:href="${payment.getUrl()}"
               class="btn btn-primary btn-sm">
              Thanh toán
            </a>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Phân trang -->
  <div class="d-flex justify-content-between mt-3">
    <a th:if="${currentPage > 0}" th:href="@{/payments(page=${currentPage - 1})}" class="btn btn-outline-primary">
      ⬅ Trang trước
    </a>
    <a th:if="${hasNextPage}" th:href="@{/payments(page=${nextPage})}" class="btn btn-outline-primary">
      Trang sau ➡
    </a>
  </div>
</div>

<div th:insert="~{fragments/footer :: footer}"></div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
