<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Th√¥ng tin Ng∆∞·ªùi d√πng</title>
  <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dsuav027e/image/upload/v1740393796/favicon_llcueu.ico">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
  <!-- Bootstrap Bundle JS -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <style>
    /* C√°c ƒë·ªãnh d·∫°ng chung: √©p to√†n b·ªô n·ªôi dung cƒÉn tr√°i */
    body, h1, h2, h3, h4, h5, h6, p, th, td, div {
      text-align: left !important;
    }
    /* Sidebar */
    .sidebar-sticky {
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
      z-index: 10;
    }
    /* Header */
    .header-sticky {
      position: sticky;
      top: 0;
      z-index: 999;
      background: #fff;
    }
    /* ƒê·ªãnh d·∫°ng b·∫£ng */
    table th, table td {
      padding: 12px 15px;
      vertical-align: middle;
      text-align: left;
      border: 1px solid #dee2e6;
    }
    table th {
      white-space: nowrap;
    }
    /* C√°c c·ªôt c√≥ n·ªôi dung d√†i */
    th.username, td.username { min-width: 220px; }
    th.join-date, td.join-date { min-width: 200px; }
    th.address, td.address { min-width: 220px; }
    th.description, td.description { min-width: 250px; }
    th.email, td.email { min-width: 180px; }
    th.coin, td.coin, th.phone, td.phone, th.role, td.role, th.birth, td.birth, th.active, td.active {
      min-width: 120px;
    }
    th.firstname, td.firstname { min-width: 150px; }
    th.lastname, td.lastname { min-width: 150px; }
    th.grade, td.grade { min-width: 80px; }
    th.school, td.school { min-width: 150px; }
    /* C·ªôt T√†i kho·∫£n: cƒÉn ch·ªânh avatar v√† username theo h√†ng ngang */
    .user-account {
      text-align: left;
    }
    .user-account img {
      margin-right: 8px;
    }
    /* Nav Tabs: s·ª≠ d·ª•ng Bootstrap nav-tabs */
    .nav-tabs {
      border-bottom: 2px solid #dee2e6;
      margin-bottom: 1rem;
    }
    .nav-tabs .nav-link {
      border: none;
      color: #000;
    }
    .nav-tabs .nav-link.active {
      color: #6f42c1; /* M√†u t√≠m cho tab active */
      border-bottom: 2px solid #6f42c1;
    }
    /* Tab Content */
    .tab-content {
      border: 1px solid #dee2e6;
      border-top: none;
      padding: 1rem;
    }
  </style>
</head>
<body class="bg-white">
<div class="container-fluid">
  <div class="row">
    <!-- Sidebar -->
    <div class="col-2 bg-light px-3 py-4 sidebar-sticky">
      <div class="text-center mb-4">
        <img src="/img/logo.png" alt="Logo" class="img-fluid mb-3">
      </div>
      <h2 class="h5 fw-bold">üé© Dashboard</h2>
      <ul class="nav flex-column mt-4">
        <li class="nav-item mb-2">
          <a href="/admin/users" class="nav-link">üë• Qu·∫£n l√≠ Ng∆∞·ªùi d√πng</a>
        </li>
        <li class="nav-item mb-2">
          <a href="/admin/exams" class="nav-link">üìù Qu·∫£n l√≠ ƒê·ªÅ thi</a>
        </li>
        <li class="nav-item mb-2">
          <a href="/admin/posts" class="nav-link">üìÑ Qu·∫£n l√≠ B√†i vi·∫øt</a>
        </li>
        <li class="nav-item mb-2">
          <a href="/admin/stats" class="nav-link">üìä Th·ªëng k√™</a>
        </li>
        <li class="nav-item mt-3">
          <a href="/logout" class="nav-link text-danger">üö™ ƒêƒÉng xu·∫•t</a>
        </li>
      </ul>
    </div>

    <!-- Main Content -->
    <div class="col-10 px-0">
      <!-- Header -->
      <div class="header-sticky shadow-sm p-4 mb-4">
        <div class="d-flex justify-content-between align-items-center">
          <h1 class="h3 fw-bold m-0">Th√¥ng tin Ng∆∞·ªùi d√πng</h1>
          <div class="d-flex align-items-center">
            <div class="me-3">
              <input type="text" placeholder="üîç T√¨m ki·∫øm..." class="form-control" style="width: 200px;">
            </div>
            <div class="d-flex align-items-center">
              <span th:text="${adminUser.username}">Admin</span>
              <img th:src="${adminUser.avatarUrl}" alt="Admin Avatar" class="rounded-circle border border-secondary" style="width:40px; height:40px; margin-left: 8px;">
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content: Tabs ph√¢n lo·∫°i ng∆∞·ªùi d√πng -->
      <div class="px-4">
        <h2 class="h5 fw-bold mb-3">Danh s√°ch Ng∆∞·ªùi d√πng</h2>

        <!-- Nav Tabs -->
        <ul class="nav nav-tabs mb-3">
          <li class="nav-item">
            <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tab-all">T·∫•t c·∫£</button>
          </li>
          <li class="nav-item">
            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-student">H·ªçc sinh</button>
          </li>
          <li class="nav-item">
            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-teacher">Gi√°o vi√™n</button>
          </li>
          <li class="nav-item">
            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-upgraded">T√†i kho·∫£n n√¢ng c·∫•p</button>
          </li>
          <li class="nav-item">
            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-pending">X√©t duy·ªát gi√°o vi√™n</button>
          </li>
          <li class="nav-item">
            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-admin">Qu·∫£n tr·ªã vi√™n</button>
          </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content">
          <!-- Tab T·ªïng s·ªë: hi·ªÉn th·ªã to√†n b·ªô ng∆∞·ªùi d√πng -->
          <div class="tab-pane fade show active" id="tab-all">
            <h5 class="fw-bold mb-3">T·ªïng s·ªë Ng∆∞·ªùi d√πng</h5>
            <div class="table-responsive">
              <table class="table table-bordered table-striped">
                <thead class="table-secondary">
                <tr>
                  <th class="username">T√†i kho·∫£n</th>
                  <th class="email">Email</th>
                  <th class="phone">S·ªë ƒëi·ªán tho·∫°i</th>
                  <th class="active">Tr·∫°ng th√°i</th>
                  <th class="role">Vai tr√≤</th>
                  <th class="coin">Coin</th>
                  <th class="join-date">Ng√†y tham gia</th>
                  <th>X√°c th·ª±c</th>
                  <th class="firstname">H·ªç</th>
                  <th class="lastname">T√™n</th>
                  <th class="birth">Ng√†y sinh</th>
                  <th class="address">ƒê·ªãa ch·ªâ</th>
                  <th class="grade">L·ªõp</th>
                  <th>M√£ h·ªçc sinh</th>
                  <th class="description">M√¥ t·∫£</th>
                  <th>M√£ gi√°o vi√™n</th>
                  <th class="school">Tr∆∞·ªùng</th>
                  <th>Chuy√™n m√¥n</th>
                  <th>Kinh nghi·ªám</th>
                  <th>Ch·ª©ng ch·ªâ</th>
                  <th>Thao t√°c</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="user : ${allUsers}">
                  <td class="user-account">
                    <div class="d-flex align-items-center">
                      <img th:src="${user.avatarUrl}" alt="User Avatar" class="rounded-circle" style="width:30px; height:30px;">
                      <span th:text="${user.username}">Username</span>
                    </div>
                  </td>
                  <td class="email" th:text="${user.email}">Email</td>
                  <td class="phone" th:text="${user.phone}">Phone</td>
                  <td>
                    <span th:style="${user.active}
                        ? 'display:inline-block; background-color:#2196f3; color:#fff; padding:6px 12px; border-radius:9999px;'
                        : 'display:inline-block; background-color:#E43161; color:#fff; padding:6px 12px; border-radius:9999px;'"
                          th:text="${user.active} ? 'Active' : 'Inactive'">
                    </span>
                  </td>
                  <td class="role text-primary" th:text="${user.role}">Role</td>
                  <td class="coin" th:text="${user.coin}">Coin</td>
                  <td class="join-date" th:text="${user.getFormattedJoinTime()}">Join Date</td>
                  <td th:text="${user.verified}">Verified</td>

                  <td class="firstname" th:text="${user.firstName}">H·ªç</td>
                  <td class="lastname" th:text="${user.lastName}">T√™n</td>
                  <td class="birth" th:text="${user.birthDate}">Birth Date</td>
                  <td class="address" th:text="${user.address}">Address</td>
                  <td class="grade" th:text="${user.grade}">Grade</td>
                  <td th:text="${user.studentId}">Student ID</td>
                  <td class="description" th:text="${user.description}">Description</td>
                  <td th:text="${user.teacherCode}">Teacher Code</td>
                  <td class="school" th:text="${user.school}">School</td>
                  <td th:text="${user.speciality}">Speciality</td>
                  <td th:text="${user.experience}">Experience</td>
                  <td th:text="${user.degreeUrl}">Degree URL</td>
                  <td class="text-center">
                    <div class="d-flex justify-content-start align-items-center" style="white-space: nowrap;">
                      <!-- Form c·∫≠p nh·∫≠t vai tr√≤ -->
                      <form action="/admin/changeRole" method="post" class="d-inline-flex align-items-center">
                        <input type="hidden" name="username" th:value="${user.username}">
                        <select name="newRole" class="form-select w-auto">
                          <option value="STUDENT" th:selected="${user.role == 'STUDENT'}">STUDENT</option>
                          <option value="TEACHER" th:selected="${user.role == 'TEACHER'}">TEACHER</option>
                          <option value="ADMIN" th:selected="${user.role == 'ADMIN'}">ADMIN</option>
                          <option value="UPGRADED_USER" th:selected="${user.role == 'UPGRADED_USER'}">UPGRADED_STUDENT</option>
                          <option value="PENDING_TEACHER" th:selected="${user.role == 'PENDING_TEACHER'}">PENDING_TEACHER</option>
                        </select>
                        <button type="submit" class="btn btn-success btn-sm ms-2">üíæ L∆∞u</button>
                      </form>
                      <!-- Form c·∫≠p nh·∫≠t tr·∫°ng th√°i -->
                      <form action="/admin/updateUserStatus" method="post" class="d-inline-flex align-items-center ms-2">
                        <input type="hidden" name="username" th:value="${user.username}">
                        <button type="submit"
                                th:class="'btn btn-sm ' + (${user.active} ? 'btn-danger' : 'btn-success')"
                                th:text="${user.active} ? 'üö´ V√¥ hi·ªáu h√≥a' : '‚úÖ K√≠ch ho·∫°t l·∫°i'">
                        </button>

                      </form>
                    </div>
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
            <div class="my-4">
              <canvas id="userRoleChart" style="max-width:600px; max-height:400px;"></canvas>
            </div>
          </div>
          <!-- Tab H·ªçc sinh -->
          <div class="tab-pane fade" id="tab-student">
            <h5 class="fw-bold mb-3">H·ªçc sinh (Student)</h5>
            <div class="table-responsive">
              <table class="table table-bordered table-striped">
                <thead class="table-secondary">
                <tr>
                  <th class="username">T√†i kho·∫£n</th>
                  <th class="email">Email</th>
                  <th class="phone">S·ªë ƒëi·ªán tho·∫°i</th>
                  <th class="active">Tr·∫°ng th√°i</th>
                  <th class="role">Vai tr√≤</th>
                  <th class="coin">Coin</th>
                  <th class="join-date">Ng√†y tham gia</th>
                  <th>X√°c th·ª±c</th>
                  <th class="firstname">H·ªç</th>
                  <th class="lastname">T√™n</th>
                  <th class="birth">Ng√†y sinh</th>
                  <th class="address">ƒê·ªãa ch·ªâ</th>
                  <th class="grade">L·ªõp</th>
                  <th>M√£ h·ªçc sinh</th>
                  <th class="description">M√¥ t·∫£</th>
                  <th class="school">Tr∆∞·ªùng</th>
                  <th>Thao t√°c</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="user : ${students}">
                  <td class="user-account">
                    <div class="d-flex align-items-center">
                      <img th:src="${user.avatarUrl}" alt="User Avatar" class="rounded-circle" style="width:30px; height:30px;">
                      <span th:text="${user.username}">Username</span>
                    </div>
                  </td>
                  <td class="email" th:text="${user.email}">Email</td>
                  <td class="phone" th:text="${user.phone}">Phone</td>
                  <td>
                    <span th:style="${user.active}
                        ? 'display:inline-block; background-color:#2196f3; color:#fff; padding:6px 12px; border-radius:9999px;'
                        : 'display:inline-block; background-color:#E43161; color:#fff; padding:6px 12px; border-radius:9999px;'"
                          th:text="${user.active} ? 'Active' : 'Inactive'">
                    </span>
                  </td>
                  <td class="role text-primary" th:text="${user.role}">Role</td>
                  <td class="coin" th:text="${user.coin}">Coin</td>
                  <td class="join-date" th:text="${user.getFormattedJoinTime()}">Join Date</td>
                  <td th:text="${user.verified}">Verified</td>
                  <td class="firstname" th:text="${user.firstName}">H·ªç</td>
                  <td class="lastname" th:text="${user.lastName}">T√™n</td>
                  <td class="birth" th:text="${user.birthDate}">Birth Date</td>
                  <td class="address" th:text="${user.address}">Address</td>
                  <td class="grade" th:text="${user.grade}">Grade</td>
                  <td th:text="${user.studentId}">Student ID</td>
                  <td class="description" th:text="${user.description}">Description</td>
                  <td class="school" th:text="${user.school}">School</td>
                  <td class="text-center">
                    <div class="d-flex justify-content-start align-items-center" style="white-space: nowrap;">
                      <!-- Form c·∫≠p nh·∫≠t vai tr√≤ -->
                      <form action="/admin/changeRole" method="post" class="d-inline-flex align-items-center">
                        <input type="hidden" name="username" th:value="${user.username}">
                        <select name="newRole" class="form-select w-auto">
                          <option value="STUDENT" th:selected="${user.role == 'STUDENT'}">STUDENT</option>
                          <option value="TEACHER" th:selected="${user.role == 'TEACHER'}">TEACHER</option>
                          <option value="ADMIN" th:selected="${user.role == 'ADMIN'}">ADMIN</option>
                          <option value="UPGRADED_USER" th:selected="${user.role == 'UPGRADED_USER'}">UPGRADED_STUDENT</option>
                          <option value="PENDING_TEACHER" th:selected="${user.role == 'PENDING_TEACHER'}">PENDING_TEACHER</option>
                        </select>
                        <button type="submit" class="btn btn-success btn-sm ms-2">üíæ L∆∞u</button>
                      </form>
                      <!-- Form c·∫≠p nh·∫≠t tr·∫°ng th√°i -->
                      <form action="/admin/updateUserStatus" method="post" class="d-inline-flex align-items-center ms-2">
                        <input type="hidden" name="username" th:value="${user.username}">
                        <button type="submit"
                                th:class="'btn btn-sm ' + (${user.active} ? 'btn-danger' : 'btn-success')"
                                th:text="${user.active} ? 'üö´ V√¥ hi·ªáu h√≥a' : '‚úÖ K√≠ch ho·∫°t l·∫°i'">
                        </button>

                      </form>
                    </div>
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
          <!-- Tab Gi√°o vi√™n -->
          <div class="tab-pane fade" id="tab-teacher">
            <h5 class="fw-bold mb-3">Gi√°o vi√™n (TEACHER)</h5>
            <div class="table-responsive">
              <table class="table table-bordered table-striped">
                <thead class="table-secondary">
                <tr>
                  <th class="username">T√†i kho·∫£n</th>
                  <th class="email">Email</th>
                  <th class="phone">S·ªë ƒëi·ªán tho·∫°i</th>
                  <th class="active">Tr·∫°ng th√°i</th>
                  <th class="role">Vai tr√≤</th>
                  <th class="coin">Coin</th>
                  <th class="join-date">Ng√†y tham gia</th>
                  <th>X√°c th·ª±c</th>
                  <th class="firstname">H·ªç</th>
                  <th class="lastname">T√™n</th>
                  <th class="birth">Ng√†y sinh</th>
                  <th class="address">ƒê·ªãa ch·ªâ</th>
                  <th class="description">M√¥ t·∫£</th>
                  <th>M√£ gi√°o vi√™n</th>
                  <th class="school">Tr∆∞·ªùng</th>
                  <th>Chuy√™n m√¥n</th>
                  <th>Kinh nghi·ªám</th>
                  <th>Ch·ª©ng ch·ªâ</th>
                  <th>Thao t√°c</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="user : ${teachers}">
                  <td class="user-account">
                    <div class="d-flex align-items-center">
                      <img th:src="${user.avatarUrl}" alt="User Avatar" class="rounded-circle" style="width:30px; height:30px;">
                      <span th:text="${user.username}">Username</span>
                    </div>
                  </td>
                  <td class="email" th:text="${user.email}">Email</td>
                  <td class="phone" th:text="${user.phone}">Phone</td>
                  <td>
                    <span th:style="${user.active}
                        ? 'display:inline-block; background-color:#2196f3; color:#fff; padding:6px 12px; border-radius:9999px;'
                        : 'display:inline-block; background-color:#E43161; color:#fff; padding:6px 12px; border-radius:9999px;'"
                          th:text="${user.active} ? 'Active' : 'Inactive'">
                    </span>
                  </td>
                  <td class="role text-primary" th:text="${user.role}">Role</td>
                  <td class="coin" th:text="${user.coin}">Coin</td>
                  <td class="join-date" th:text="${user.getFormattedJoinTime()}">Join Date</td>
                  <td th:text="${user.verified}">Verified</td>
                  <td class="firstname" th:text="${user.firstName}">H·ªç</td>
                  <td class="lastname" th:text="${user.lastName}">T√™n</td>
                  <td class="birth" th:text="${user.birthDate}">Birth Date</td>
                  <td class="address" th:text="${user.address}">Address</td>
                  <td class="description" th:text="${user.description}">Description</td>
                  <td th:text="${user.teacherCode}">Teacher Code</td>
                  <td class="school" th:text="${user.school}">School</td>
                  <td th:text="${user.speciality}">Speciality</td>
                  <td th:text="${user.experience}">Experience</td>
                  <td th:text="${user.degreeUrl}">Degree URL</td>
                  <td class="text-center">
                    <div class="d-flex justify-content-start align-items-center" style="white-space: nowrap;">
                      <!-- Form c·∫≠p nh·∫≠t vai tr√≤ -->
                      <form action="/admin/changeRole" method="post" class="d-inline-flex align-items-center">
                        <input type="hidden" name="username" th:value="${user.username}">
                        <select name="newRole" class="form-select w-auto">
                          <option value="STUDENT" th:selected="${user.role == 'STUDENT'}">STUDENT</option>
                          <option value="TEACHER" th:selected="${user.role == 'TEACHER'}">TEACHER</option>
                          <option value="ADMIN" th:selected="${user.role == 'ADMIN'}">ADMIN</option>
                          <option value="UPGRADED_USER" th:selected="${user.role == 'UPGRADED_USER'}">UPGRADED_STUDENT</option>
                          <option value="PENDING_TEACHER" th:selected="${user.role == 'PENDING_TEACHER'}">PENDING_TEACHER</option>
                        </select>
                        <button type="submit" class="btn btn-success btn-sm ms-2">üíæ L∆∞u</button>
                      </form>
                      <!-- Form c·∫≠p nh·∫≠t tr·∫°ng th√°i -->
                      <form action="/admin/updateUserStatus" method="post" class="d-inline-flex align-items-center ms-2">
                        <input type="hidden" name="username" th:value="${user.username}">
                        <button type="submit"
                                th:class="'btn btn-sm ' + (${user.active} ? 'btn-danger' : 'btn-success')"
                                th:text="${user.active} ? 'üö´ V√¥ hi·ªáu h√≥a' : '‚úÖ K√≠ch ho·∫°t l·∫°i'">
                        </button>

                      </form>
                    </div>
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
          <!-- Tab Upgrade h·ªçc sinh -->
          <div class="tab-pane fade" id="tab-upgraded">
            <h5 class="fw-bold mb-3">Upgrade h·ªçc sinh (UPGRADED_USER)</h5>
            <div class="table-responsive">
              <table class="table table-bordered table-striped">
                <thead class="table-secondary">
                <tr>
                  <th class="username">T√†i kho·∫£n</th>
                  <th class="email">Email</th>
                  <th class="phone">S·ªë ƒëi·ªán tho·∫°i</th>
                  <th class="active">Tr·∫°ng th√°i</th>
                  <th class="role">Vai tr√≤</th>
                  <th class="coin">Coin</th>
                  <th class="join-date">Ng√†y tham gia</th>
                  <th>X√°c th·ª±c</th>
                  <th class="firstname">H·ªç</th>
                  <th class="lastname">T√™n</th>
                  <th class="birth">Ng√†y sinh</th>
                  <th class="address">ƒê·ªãa ch·ªâ</th>
                  <th class="grade">L·ªõp</th>
                  <th>M√£ h·ªçc sinh</th>
                  <th class="description">M√¥ t·∫£</th>
                  <th class="school">Tr∆∞·ªùng</th>
                  <th>Thao t√°c</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="user : ${upgraded}">
                  <td class="user-account">
                    <div class="d-flex align-items-center">
                      <img th:src="${user.avatarUrl}" alt="User Avatar" class="rounded-circle" style="width:30px; height:30px;">
                      <span th:text="${user.username}">Username</span>
                    </div>
                  </td>
                  <td class="email" th:text="${user.email}">Email</td>
                  <td class="phone" th:text="${user.phone}">Phone</td>
                  <td>
                    <span th:style="${user.active}
                        ? 'display:inline-block; background-color:#2196f3; color:#fff; padding:6px 12px; border-radius:9999px;'
                        : 'display:inline-block; background-color:#E43161; color:#fff; padding:6px 12px; border-radius:9999px;'"
                          th:text="${user.active} ? 'Active' : 'Inactive'">
                    </span>
                  </td>
                  <td class="role text-primary" th:text="${user.role}">Role</td>
                  <td class="coin" th:text="${user.coin}">Coin</td>
                  <td class="join-date" th:text="${user.getFormattedJoinTime()}">Join Date</td>
                  <td th:text="${user.verified}">Verified</td>
                  <td class="firstname" th:text="${user.firstName}">H·ªç</td>
                  <td class="lastname" th:text="${user.lastName}">T√™n</td>
                  <td class="birth" th:text="${user.birthDate}">Birth Date</td>
                  <td class="address" th:text="${user.address}">Address</td>
                  <td class="grade" th:text="${user.grade}">Grade</td>
                  <td th:text="${user.studentId}">Student ID</td>
                  <td class="description" th:text="${user.description}">Description</td>
                  <td class="school" th:text="${user.school}">School</td>
                  <td class="text-center">
                    <div class="d-flex justify-content-start align-items-center" style="white-space: nowrap;">
                      <!-- Form c·∫≠p nh·∫≠t vai tr√≤ -->
                      <form action="/admin/changeRole" method="post" class="d-inline-flex align-items-center">
                        <input type="hidden" name="username" th:value="${user.username}">
                        <select name="newRole" class="form-select w-auto">
                          <option value="STUDENT" th:selected="${user.role == 'STUDENT'}">STUDENT</option>
                          <option value="TEACHER" th:selected="${user.role == 'TEACHER'}">TEACHER</option>
                          <option value="ADMIN" th:selected="${user.role == 'ADMIN'}">ADMIN</option>
                          <option value="UPGRADED_USER" th:selected="${user.role == 'UPGRADED_USER'}">UPGRADED_STUDENT</option>
                          <option value="PENDING_TEACHER" th:selected="${user.role == 'PENDING_TEACHER'}">PENDING_TEACHER</option>
                        </select>
                        <button type="submit" class="btn btn-success btn-sm ms-2">üíæ L∆∞u</button>
                      </form>
                      <!-- Form c·∫≠p nh·∫≠t tr·∫°ng th√°i -->
                      <form action="/admin/updateUserStatus" method="post" class="d-inline-flex align-items-center ms-2">
                        <input type="hidden" name="username" th:value="${user.username}">
                        <button type="submit"
                                th:class="'btn btn-sm ' + (${user.active} ? 'btn-danger' : 'btn-success')"
                                th:text="${user.active} ? 'üö´ V√¥ hi·ªáu h√≥a' : '‚úÖ K√≠ch ho·∫°t l·∫°i'">
                        </button>

                      </form>
                    </div>
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Tab X√©t duy·ªát Gi√°o vi√™n -->
          <div class="tab-pane fade" id="tab-pending">
            <h5 class="fw-bold mb-3">X√©t duy·ªát l√† Gi√°o vi√™n</h5>
            <div class="table-responsive">
              <table class="table table-bordered table-striped">
                <thead class="table-secondary">
                <tr>
                  <th class="username">T√†i kho·∫£n</th>
                  <th class="email">Email</th>
                  <th class="phone">S·ªë ƒëi·ªán tho·∫°i</th>
                  <th class="active">Tr·∫°ng th√°i</th>
                  <th class="role">Vai tr√≤</th>
                  <th class="coin">Coin</th>
                  <th class="join-date">Ng√†y tham gia</th>
                  <th>X√°c th·ª±c</th>
                  <th class="firstname">H·ªç</th>
                  <th class="lastname">T√™n</th>
                  <th class="birth">Ng√†y sinh</th>
                  <th class="address">ƒê·ªãa ch·ªâ</th>
                  <th class="description">M√¥ t·∫£</th>
                  <th>M√£ gi√°o vi√™n</th>
                  <th class="school">Tr∆∞·ªùng</th>
                  <th>Chuy√™n m√¥n</th>
                  <th>Kinh nghi·ªám</th>
                  <th>Ch·ª©ng ch·ªâ</th>
                  <th>Thao t√°c</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="user : ${pending}">
                  <td class="user-account">
                    <div class="d-flex align-items-center">
                      <img th:src="${user.avatarUrl}" alt="User Avatar" class="rounded-circle" style="width:30px; height:30px;">
                      <span th:text="${user.username}">Username</span>
                    </div>
                  </td>
                  <td class="email" th:text="${user.email}">Email</td>
                  <td class="phone" th:text="${user.phone}">Phone</td>
                  <td>
                    <span th:style="${user.active}
                        ? 'display:inline-block; background-color:#2196f3; color:#fff; padding:6px 12px; border-radius:9999px;'
                        : 'display:inline-block; background-color:#E43161; color:#fff; padding:6px 12px; border-radius:9999px;'"
                          th:text="${user.active} ? 'Active' : 'Inactive'">
                    </span>
                  </td>
                  <td class="role text-primary" th:text="${user.role}">Role</td>
                  <td class="coin" th:text="${user.coin}">Coin</td>
                  <td class="join-date" th:text="${user.getFormattedJoinTime()}">Join Date</td>
                  <td th:text="${user.verified}">Verified</td>
                  <td class="firstname" th:text="${user.firstName}">H·ªç</td>
                  <td class="lastname" th:text="${user.lastName}">T√™n</td>
                  <td class="birth" th:text="${user.birthDate}">Birth Date</td>
                  <td class="address" th:text="${user.address}">Address</td>
                  <td class="description" th:text="${user.description}">Description</td>
                  <td th:text="${user.teacherCode}">Teacher Code</td>
                  <td class="school" th:text="${user.school}">School</td>
                  <td th:text="${user.speciality}">Speciality</td>
                  <td th:text="${user.experience}">Experience</td>
                  <td th:text="${user.degreeUrl}">Degree URL</td>
                  <td class="text-center">
                    <div class="d-flex justify-content-start align-items-center" style="white-space: nowrap;">
                      <!-- Form ch·∫•p nh·∫≠n gi√°o vi√™n -->
                      <form action="/admin/approveTeacher" method="post" class="d-inline-flex align-items-center">
                        <input type="hidden" name="username" th:value="${user.username}">
                        <button type="submit" class="btn btn-success btn-sm ms-2">‚úÖ Ch·∫•p nh·∫≠n</button>
                      </form>
                      <!-- Form t·ª´ ch·ªëi gi√°o vi√™n -->
                      <form action="/admin/rejectTeacher" method="post" class="d-inline-flex align-items-center ms-2">
                        <input type="hidden" name="username" th:value="${user.username}">
                        <button type="submit" class="btn btn-danger btn-sm ms-2">‚ùå T·ª´ ch·ªëi</button>
                      </form>
                    </div>
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
          <!-- Tab Admin -->
          <div class="tab-pane fade" id="tab-admin">
            <h5 class="fw-bold mb-3">Qu·∫£n tr·ªã vi√™n(ADMIN)</h5>
            <div class="table-responsive">
              <table class="table table-bordered table-striped">
                <thead class="table-secondary">
                <tr>
                  <th class="username">T√†i kho·∫£n</th>
                  <th class="email">Email</th>
                  <th class="phone">S·ªë ƒëi·ªán tho·∫°i</th>
                  <th class="active">Tr·∫°ng th√°i</th>
                  <th class="coin">Coin</th>
                  <th>X√°c th·ª±c</th>
                  <th class="firstname">H·ªç</th>
                  <th class="lastname">T√™n</th>
                  <th class="birth">Ng√†y sinh</th>
                  <th class="address">ƒê·ªãa ch·ªâ</th>
                  <th>Thao t√°c</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="user : ${admins}">
                  <td class="user-account">
                    <div class="d-flex align-items-center">
                      <img th:src="${user.avatarUrl}" alt="User Avatar" class="rounded-circle" style="width:30px; height:30px;">
                      <span th:text="${user.username}">Username</span>
                    </div>
                  </td>
                  <td class="email" th:text="${user.email}">Email</td>
                  <td class="phone" th:text="${user.phone}">Phone</td>
                  <td>
                    <span th:style="${user.active}
                        ? 'display:inline-block; background-color:#2196f3; color:#fff; padding:6px 12px; border-radius:9999px;'
                        : 'display:inline-block; background-color:#E43161; color:#fff; padding:6px 12px; border-radius:9999px;'"
                          th:text="${user.active} ? 'Active' : 'Inactive'">
                    </span>
                  </td>
                  <td class="coin" th:text="${user.coin}">Coin</td>
                  <td th:text="${user.verified}">Verified</td>
                  <td class="firstname" th:text="${user.firstName}">H·ªç</td>
                  <td class="lastname" th:text="${user.lastName}">T√™n</td>
                  <td class="birth" th:text="${user.birthDate}">Birth Date</td>
                  <td class="address" th:text="${user.address}">Address</td>
                  <td class="text-center">
                    <div class="d-flex justify-content-start align-items-center" style="white-space: nowrap;">
                      <!-- Form c·∫≠p nh·∫≠t vai tr√≤ -->
                      <form action="/admin/changeRole" method="post" class="d-inline-flex align-items-center">
                        <input type="hidden" name="username" th:value="${user.username}">
                        <select name="newRole" class="form-select w-auto">
                          <option value="STUDENT" th:selected="${user.role == 'STUDENT'}">STUDENT</option>
                          <option value="TEACHER" th:selected="${user.role == 'TEACHER'}">TEACHER</option>
                          <option value="ADMIN" th:selected="${user.role == 'ADMIN'}">ADMIN</option>
                          <option value="UPGRADED_USER" th:selected="${user.role == 'UPGRADED_USER'}">UPGRADED_STUDENT</option>
                          <option value="PENDING_TEACHER" th:selected="${user.role == 'PENDING_TEACHER'}">PENDING_TEACHER</option>
                        </select>
                        <button type="submit" class="btn btn-success btn-sm ms-2">üíæ L∆∞u</button>
                      </form>
                      <!-- Form c·∫≠p nh·∫≠t tr·∫°ng th√°i -->
                      <form action="/admin/updateUserStatus" method="post" class="d-inline-flex align-items-center ms-2">
                        <input type="hidden" name="username" th:value="${user.username}">
                        <button type="submit"
                                th:class="'btn btn-sm ' + (${user.active} ? 'btn-danger' : 'btn-success')"
                                th:text="${user.active} ? 'üö´ V√¥ hi·ªáu h√≥a' : '‚úÖ K√≠ch ho·∫°t l·∫°i'">
                        </button>

                      </form>
                    </div>
                  </td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div> <!-- End tab-content -->
      </div> <!-- End main content (px-4) -->
    </div> <!-- End col-10 -->
  </div> <!-- End row -->
</div> <!-- End container-fluid -->
<!-- Th√™m Chart.js t·ª´ CDN n·∫øu ch∆∞a c√≥ -->
<!-- Chart.js Script -->
<script th:inline="javascript">
  /*<![CDATA[*/
  var studentCount = /*[[${studentCount}]]*/ 0;
  var teacherCount = /*[[${teacherCount}]]*/ 0;
  var upgradedCount = /*[[${upgradedCount}]]*/ 0;
  var pendingCount = /*[[${pendingCount}]]*/ 0;
  var adminCount = /*[[${adminCount}]]*/ 0;
  /*]]>*/


  // C√°c nh√£n cho bi·ªÉu ƒë·ªì
  var roleLabels = ['Student', 'Teacher', 'Upgrade', 'Pending', 'Admin'];
  var roleData = [studentCount, teacherCount, upgradedCount, pendingCount, adminCount];

  // Kh·ªüi t·∫°o bi·ªÉu ƒë·ªì tr√≤n
  var ctx = document.getElementById('userRoleChart').getContext('2d');
  var userRoleChart = new Chart(ctx, {
    type: 'pie',
    data: {
      labels: roleLabels,
      datasets: [{
        data: roleData,
        backgroundColor: [
          'rgba(54, 162, 235, 0.7)',   // M√†u xanh cho H·ªçc sinh
          'rgba(255, 206, 86, 0.7)',    // M√†u v√†ng cho Gi√°o vi√™n
          'rgba(75, 192, 192, 0.7)',    // M√†u xanh l√° cho Upgrade
          'rgba(255, 99, 132, 0.7)',    // M√†u ƒë·ªè cho Pending
          'rgba(153, 102, 255, 0.7)'    // M√†u t√≠m cho Admin
        ]
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          position: 'bottom'
        }
      }
    }
  });
  /*]]>*/
</script>

</body>
</html>
