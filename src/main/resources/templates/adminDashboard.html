<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" th:href="@{/css/admin.css}">
</head>
<body>

<div class="flex h-screen">
  <!-- Sidebar -->
  <div class="sidebar w-1/5 p-5">
    <h2 class="text-xl font-bold">ğŸ© Admin Panel</h2>
    <ul class="mt-5 space-y-3">
      <li><a href="#users">ğŸ‘¥ Quáº£n lÃ½ NgÆ°á»i dÃ¹ng</a></li>
      <li><a href="#posts">ğŸ“„ Quáº£n lÃ½ BÃ i viáº¿t</a></li>
      <li><a href="#exams">ğŸ“ Quáº£n lÃ½ Äá» thi</a></li>
      <li><a href="#stats">ğŸ“Š Thá»‘ng kÃª</a></li>
      <li><a href="/logout" class="logout-btn">ğŸšª ÄÄƒng xuáº¥t</a></li>
    </ul>
  </div>

  <!-- Main Content -->
  <div class="main-content w-4/5 p-8">
    <h1 class="text-3xl font-bold">Admin Dashboard</h1>

    <!-- Báº£ng thá»‘ng kÃª -->
    <div id="stats" class="stats-container">
      <div class="stats-box">
        <h3>ğŸ‘¤ Tá»•ng tÃ i khoáº£n</h3>
        <p class="stats-number" th:text="${totalUsers}">0</p>
      </div>
      <div class="stats-box">
        <h3>ğŸ“„ Tá»•ng bÃ i viáº¿t</h3>
        <p class="stats-number" th:text="${totalPosts}">0</p>
      </div>
      <div class="stats-box">
        <h3>ğŸ“ Tá»•ng Ä‘á» thi</h3>
        <p class="stats-number" th:text="${totalExams}">0</p>
      </div>
    </div>

    <!-- Biá»ƒu Ä‘á»“ thá»‘ng kÃª -->
    <div class="charts-container">
      <canvas id="userChart"></canvas>
      <canvas id="postExamChart"></canvas>
    </div>

    <!-- Báº£ng 12 thÃ¡ng -->
    <div class="mt-10">
      <h2 class="text-2xl font-bold">ğŸ“Š Thá»‘ng kÃª BÃ i viáº¿t & Äá» thi (12 thÃ¡ng)</h2>
      <canvas id="monthlyChart"></canvas>
    </div>

    <!-- Quáº£n lÃ½ NgÆ°á»i dÃ¹ng -->
    <div id="users" class="mt-10">
      <h2 class="text-2xl font-bold">ğŸ‘¥ Quáº£n lÃ½ NgÆ°á»i dÃ¹ng</h2>
      <table class="w-full mt-4 border-collapse bg-gray-100 rounded-lg shadow-lg">
        <thead>
        <tr class="bg-gray-300 text-black">
          <th class="py-3 px-6 text-left">ğŸ“§ Email</th>
          <th class="py-3 px-6 text-left">ğŸ‘¤ TÃªn</th>
          <th class="py-3 px-6 text-left">ğŸ›¡ Vai trÃ²</th>
          <th class="py-3 px-6 text-center">âš™ï¸ HÃ nh Ä‘á»™ng</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="user : ${users}" class="border-b border-gray-400 hover:bg-gray-200 transition">
          <td class="py-3 px-6" th:text="${user.email}"></td>
          <td class="py-3 px-6" th:text="${user.username}"></td>
          <td class="py-3 px-6 font-bold text-indigo-600" th:text="${user.role}"></td>
          <td class="py-3 px-6 text-center">
            <form action="/adminDashboard/changeRole" method="post" class="inline-block">
              <input type="hidden" name="username" th:value="${user.username}">
              <select name="newRole" class="bg-gray-200 text-black px-2 py-1 rounded">
                <option value="USER" th:selected="${user.role == 'USER'}">USER</option>
                <option value="TEACHER" th:selected="${user.role == 'TEACHER'}">TEACHER</option>
                <option value="ADMIN" th:selected="${user.role == 'ADMIN'}">ADMIN</option>
                <option value="UPGRADED_USER" th:selected="${user.role == 'UPGRADED_USER'}">UPGRADED_USER</option>
              </select>
              <button type="submit" class="ml-2 bg-green-500 px-2 py-1 rounded hover:bg-green-600 transition">ğŸ’¾ LÆ°u</button>
            </form>
            <form action="/adminDashboard/deleteUser" method="post" class="inline-block">
              <input type="hidden" name="username" th:value="${user.username}">
              <button type="submit" class="ml-2 bg-red-500 px-2 py-1 rounded hover:bg-red-600 transition">ğŸ—‘ XÃ³a</button>
            </form>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

  </div>
</div>

<!-- JavaScript for Charts -->
<script>
  new Chart(document.getElementById('userChart').getContext('2d'), {
    type: 'pie',
    data: {
      labels: ['User', 'Admin', 'Teacher', 'Upgraded User'],
      datasets: [{
        data: [45, 5, 15, 10],
        backgroundColor: ['#4CAF50', '#FF6384', '#36A2EB', '#FFCE56']
      }]
    },
    options: { responsive: true, maintainAspectRatio: false }
  });

  new Chart(document.getElementById('monthlyChart').getContext('2d'), {
    type: 'bar',
    data: {
      labels: ['ThÃ¡ng 1', 'ThÃ¡ng 2', 'ThÃ¡ng 3', 'ThÃ¡ng 4', 'ThÃ¡ng 5', 'ThÃ¡ng 6',
        'ThÃ¡ng 7', 'ThÃ¡ng 8', 'ThÃ¡ng 9', 'ThÃ¡ng 10', 'ThÃ¡ng 11', 'ThÃ¡ng 12'],
      datasets: [{
        label: 'BÃ i viáº¿t',
        data: [10, 15, 8, 20, 25, 10, 30, 12, 14, 22, 18, 16],
        backgroundColor: '#36A2EB'
      }, {
        label: 'Äá» thi',
        data: [7, 10, 12, 18, 20, 14, 25, 9, 11, 19, 17, 15],
        backgroundColor: '#FFCE56'
      }]
    }
  });

</script>

</body>
</html>
