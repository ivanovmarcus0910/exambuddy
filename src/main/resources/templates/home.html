<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Learning - Học Online</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"></div>
    <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dsuav027e/image/upload/v1740393796/favicon_llcueu.ico">

<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white">
<div th:insert="~{fragments/header :: header}"></div>


<main>
    <section class="hero">
        <div class="hero-text">
            <h1>PHÁT TRIỂN & NÂNG CAO <br> KỸ NĂNG CỦA BẠN</h1>
            <p>Khám phá các chiến lược nâng cao để tối ưu hóa quá trình học tập, nâng cao kỹ năng và đạt được thành công nhanh chóng trong sự nghiệp.</p>
            <button class="explore-btn">Khám phá</button>
        </div>
        <div class="hero-image">
            <img src="hero-image.png" alt="Học viên VR">
        </div>
    </section>
    <!-- Thanh tìm kiếm -->`
<p class="search-text" style="display: flex; justify-content: center">Tìm kiếm đề thi mong muốn của bạn</p>
    <section class="search-filter">
        <div class="search-container">
         <form action="/search-by-filter" method="get">
            <select name="grade"class="search-item">
                <option value="">Chọn khối lớp</option>
                <option value="10">Lớp 10</option>
                <option value="11">Lớp 11</option>
                <option value="12">Lớp 12</option>
            </select>

            <select name="subject" class="search-item">
                <option value="">Chọn môn học</option>
                <option value="Toán">Toán</option>
                <option value="Vật Lý">Vật lý</option>
            </select>

            <select name="examType" class="search-item">
                <option value="">Chọn loại đề</option>
                <option value="Đề kiểm tra">Đề kiểm tra</option>
                <option value="Đề luyện tập">Đề luyện tập</option>
                <option value="Đề THPT QUỐC GIA">Đề THPT QUỐC GIA</option>
            </select>

            <select name="city" class="search-item" id="citySelect">
                <option value="">Chọn thành phố</option>
            </select>

            <button class="search-btn">Tìm kiếm</button>
         </form>
        </div>
    </section>
    <script>
        const cities = ["Hà Nội", "Hồ Chí Minh", "Đà Nẵng", "Hải Phòng", "Cần Thơ", "An Giang", "Bà Rịa - Vũng Tàu",
            "Bắc Giang", "Bắc Kạn", "Bạc Liêu", "Bắc Ninh", "Bến Tre", "Bình Định", "Bình Dương", "Bình Phước", "Bình Thuận", "Cà Mau",
            "Cao Bằng", "Đắk Lắk", "Đắk Nông", "Điện Biên", "Đồng Nai", "Đồng Tháp", "Gia Lai", "Hà Giang", "Hà Nam", "Hà Tĩnh", "Hải Dương",
            "Hậu Giang", "Hòa Bình", "Hưng Yên", "Khánh Hòa", "Kiên Giang", "Kon Tum", "Lai Châu", "Lâm Đồng", "Lạng Sơn", "Lào Cai", "Long An",
            "Nam Định", "Nghệ An", "Ninh Bình", "Ninh Thuận", "Phú Thọ", "Phú Yên", "Quảng Bình", "Quảng Nam", "Quảng Ngãi", "Quảng Ninh", "Quảng Trị",
            "Sóc Trăng", "Sơn La", "Tây Ninh", "Thái Bình", "Thái Nguyên", "Thanh Hóa", "Thừa Thiên Huế", "Tiền Giang", "Trà Vinh", "Tuyên Quang", "Vĩnh Long",
            "Vĩnh Phúc", "Yên Bái"];
        const citySelect = document.getElementById('citySelect');
        cities.forEach(city => {
            const option = document.createElement('option');
            option.value = city; // Giữ nguyên giá trị gốc
            option.textContent = city;
            citySelect.appendChild(option);
        });
    </script>



    <div class="popular-exams">
        <div  class="exam-grid">
            <div class="exam-card" th:each="exam : ${exams}">
                <strong th:text="${exam.examName}"></strong>

                <span><b>Môn học:</b> <span th:text="${exam.subject}"></span></span>
                <br>
                <span><b>Ngày đăng:</b> <span th:text="${exam.date}"></span></span>
                <br>
                <span><b>Câu hỏi:</b> <span th:text="${exam.questionCount}"></span></span>
                <div class="button-container">
                <div th:if="${exam.examID}">
                    <form th:action="@{/exams/{id}/detail(id=${exam.examID})}" method="get">
                        <button class="detailButton" type="submit">Xem chi tiết</button>
                    </form>
                </div>

                <!-- Nút Like -->
<!--                <form th:action="@{/exams/{id}/like(id=${exam.examID})}" method="get">-->
<!--                    <button type="submit">Like</button>-->
<!--                </form>-->

                <button class="likeButton" th:attr="data-exam-id=${exam.examID}, data-liked=${isLiked}">
                    <i class="fa-regular fa-heart"></i>
                </button>
                </div>
                <!-- Thêm Font Awesome -->
</div>

        </div>
<div class="rank-panel">
    <h4>BXH học sinh có điểm số cao nhất</h4>
    <ul>
        <li><div class="avatar">A</div> Username1 - Điểm</li>
        <li><div class="avatar">B</div> Username2 - Điểm</li>
        <li><div class="avatar">C</div> Username3 - Điểm</li>
        <li><div class="avatar">D</div> Username4 - Điểm</li>
        <li><div class="avatar">E</div> Username5 - Điểm</li>
    </ul>
    <h4>BXH đóng góp</h4>
    <ul>
        <li><div class="avatar">A</div> Username1 - Điểm đóng góp</li>
        <li><div class="avatar">B</div> Username2 - Điểm đóng góp</li>
        <li><div class="avatar">C</div> Username3 - Điểm đóng góp</li>
        <li><div class="avatar">D</div> Username4 - Điểm đóng góp</li>
        <li><div class="avatar">E</div> Username5 - Điểm đóng góp</li>
    </ul>
</div>

</div>

<div class="pagination">
    <a th:if="${currentPage > 0}" th:href="@{/home(page=${prevPage},size=${size})}">«   </a>
    <span> <span th:text="${currentPage + 1}"></span></span>
    <a th:href="@{/home(page=${nextPage},size=${size})}">   »</a>
</div>

</main>
<script>
    document.querySelectorAll(".likeButton").forEach(button => {
        let examId = button.getAttribute("data-exam-id");
        let icon = button.querySelector("i");

        // Kiểm tra trạng thái like khi trang tải
        fetch(`/exams/${examId}/isLiked`)
            .then(response => response.json())
            .then(data => {
                if (data.liked) {
                    button.classList.add("liked");
                    icon.classList.replace("fa-regular", "fa-solid");
                }
            })
            .catch(error => console.error("Lỗi kiểm tra like:", error));

        // Toggle Like/Unlike
        button.addEventListener("click", function() {
            let isLiked = button.classList.contains("liked");

            fetch(`/exams/${examId}/like`, {
                method: isLiked ? "DELETE" : "POST"
            })
                .then(response => response.json())
                .then(data => {
                    if (data.message === "Bạn cần đăng nhập để like.") {
                        if (confirm("Bạn cần đăng nhập để like. Chuyển đến trang đăng nhập?")) {
                            window.location.href = "/login";
                        }
                        return;
                    }

                    // Chỉ thay đổi giao diện, không hiện thông báo
                    button.classList.toggle("liked");
                    icon.classList.toggle("fa-solid");
                    icon.classList.toggle("fa-regular");
                })
                .catch(error => console.error("Lỗi:", error));
        });
    });

</script>
<div th:insert="~{fragments/footer :: footer}"></div>


</html>